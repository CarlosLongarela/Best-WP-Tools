// Copyright (C) Carlos Longarela 2023/4/5 https://tabernawp.com/ <carlos@longarela.eu>
{"version":3,"sources":["general.js"],"names":["utils","translator","html","let","i","length","attrs_to_check","replacer","text","replace","str","g1","chrome","i18n","getMessage","trim","attributes","forEach","el","value","nodeType","data","childNodes","this","ajax","url","fn","request","XMLHttpRequest","onreadystatechange","readyState","response","open","responseType","send","create","htmlStr","frag","document","createDocumentFragment","temp","createElement","tags","DOMParser","parseFromString","getElementsByTagName","innerHTML","tag","appendChild","firstChild","get_current_tab","self","tabs","query","active","currentWindow","substring","url_not_valid","fragment","notice","getElementById","hide_div","show_div","div_id","our_div","style","display","show_hide_div","sleep","milliseconds","start","Date","getTime","show_data_div","our_data","data_style","height","overflow","opacity","copy_text","copyText","our_notice","select","navigator","clipboard","writeText","textContent","setTimeout","extract_hostname","hostname","indexOf","split"],"mappings":"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","file":"../general.min.js","sourcesContent":["\"use strict\";\nconst utils = {\n    translator: function (html) {\n        let i, length, attrs_to_check = ['title', 'alt', 'placeholder', 'value', 'href'];\n        function replacer(text) {\n            return text.replace(/\\{\\{([\\s\\S]*?)\\}\\}/gm, function (str, g1) {\n                return chrome.i18n.getMessage(g1.trim()) || str;\n            });\n        }\n        if (html.attributes) {\n            attrs_to_check.forEach(function (el) {\n                if (html.attributes[el]) {\n                    html.attributes[el].value = replacer(html.attributes[el].value);\n                }\n            });\n        }\n        if (3 === html.nodeType) {\n            html.data = replacer(html.data);\n        }\n        else {\n            for (i = 0, length = html.childNodes.length; i < length; i++) {\n                this.translator(html.childNodes[i]);\n            }\n        }\n    },\n    ajax: function (url, fn) {\n        let request = new XMLHttpRequest();\n        request.onreadystatechange = function () {\n            if (4 === request.readyState) {\n                fn(request.response);\n            }\n        };\n        request.open('GET', url, true);\n        request.responseType = 'json';\n        request.send();\n    },\n    create: function (htmlStr) {\n        let frag = document.createDocumentFragment(), temp = document.createElement('div');\n        const parser = new DOMParser();\n        const parsed = parser.parseFromString(htmlStr, 'text/html');\n        const tags = parsed.getElementsByTagName('body');\n        temp.innerHTML = '';\n        for (const tag of tags) {\n            temp.appendChild(tag);\n        }\n        while (temp.firstChild) {\n            frag.appendChild(temp.firstChild);\n        }\n        return frag;\n    },\n    get_current_tab: function (fn) {\n        let self = this;\n        chrome.tabs.query({ 'active': true, 'currentWindow': true }, function (tabs) {\n            if (tabs.length > 0) {\n                if ('http' !== tabs[0].url.substring(0, 4)) {\n                    self.url_not_valid();\n                }\n                else {\n                    fn(tabs[0]);\n                }\n            }\n            else {\n                self.url_not_valid();\n            }\n        });\n    },\n    url_not_valid: function () {\n        let fragment = this.create('<p>' + chrome.i18n.getMessage('msg_only_http') + '</p><p>' + chrome.i18n.getMessage('msg_2_only_http') + ' <a href=\"https://tabernawp.com/best-wordpress-tools\" target=\"_blank\" rel=\"noopener\">https://tabernawp.com/best-wordpress-tools</a></p>');\n        let notice = document.getElementById('notice');\n        if (notice) {\n            notice.appendChild(fragment);\n        }\n        this.hide_div('app_info');\n        this.hide_div('no_cache_page');\n        this.show_div('notice');\n    },\n    show_div: function (div_id) {\n        let our_div = document.getElementById(div_id);\n        if (our_div) {\n            our_div.style.display = 'block';\n        }\n    },\n    hide_div: function (div_id) {\n        let our_div = document.getElementById(div_id);\n        if (our_div) {\n            our_div.style.display = 'none';\n        }\n    },\n    show_hide_div: function (div_id) {\n        let our_div = document.getElementById(div_id);\n        if (our_div) {\n            if ('none' === our_div.style.display) {\n                this.show_div(div_id);\n            }\n            else {\n                this.hide_div(div_id);\n            }\n        }\n    },\n    sleep: function (milliseconds) {\n        let start = new Date().getTime();\n        for (let i = 0; i < 1e7; i++) {\n            if ((new Date().getTime() - start) > milliseconds) {\n                break;\n            }\n        }\n    },\n    show_data_div: function () {\n        let our_data = document.getElementById('data');\n        if (our_data) {\n            let data_style = our_data.style;\n            data_style.height = 'auto';\n            data_style.overflow = 'auto';\n            data_style.opacity = '1';\n        }\n    },\n    copy_text: function (div_id) {\n        let self = this;\n        let copyText = document.getElementById(div_id);\n        let our_notice = document.getElementById('notice');\n        copyText.select();\n        navigator.clipboard.writeText(copyText.value);\n        if (our_notice) {\n            our_notice.textContent = chrome.i18n.getMessage('msg_text_copied');\n            ;\n        }\n        this.show_div('notice');\n        setTimeout(function () {\n            self.hide_div('notice');\n        }, 4000);\n    },\n    extract_hostname: function (url) {\n        let hostname;\n        if (url.indexOf('://') > -1) {\n            hostname = url.split('/')[2];\n        }\n        else {\n            hostname = url.split('/')[0];\n        }\n        hostname = hostname.split(':')[0];\n        hostname = hostname.split('?')[0];\n        return hostname;\n    },\n};\n"]}